{
  "template": [
    {
      "path": "accounts/6000085367/containers/30089014/workspaces/4/templates/7",
      "accountId": "6000085367",
      "containerId": "30089014",
      "workspaceId": "4",
      "templateId": "7",
      "name": "Test Template",
      "fingerprint": "1695405447665",
      "templateData": "___TERMS_OF_SERVICE___\n\nBy creating or modifying this file you agree to Google Tag Manager's Community\nTemplate Gallery Developer Terms of Service available at\nhttps://developers.google.com/tag-manager/gallery-tos (or such other URL as\nGoogle may provide), as modified from time to time.\n\n\n___INFO___\n\n{\n  \"type\": \"TAG\",\n  \"id\": \"cvt_temp_public_id\",\n  \"version\": 1,\n  \"securityGroups\": [],\n  \"displayName\": \"Test Template\",\n  \"brand\": {\n    \"id\": \"brand_dummy\",\n    \"displayName\": \"\"\n  },\n  \"description\": \"\",\n  \"containerContexts\": [\n    \"WEB\"\n  ]\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[]\n\n\n___SANDBOXED_JS_FOR_WEB_TEMPLATE___\n\n// Enter your template code here.\nconst log = require('logToConsole');\nlog('data =', data);\nlog('this is a test using the explorer');\n\n// Call data.gtmOnSuccess when the tag is finished.\ndata.gtmOnSuccess();\n\n\n___WEB_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"logging\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"environments\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"debug\"\n          }\n        }\n      ]\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios: []\n\n\n___NOTES___\n\n\n\n\n"
    },
    {
      "path": "accounts/6000085367/containers/30089014/workspaces/4/templates/9",
      "accountId": "6000085367",
      "containerId": "30089014",
      "workspaceId": "4",
      "templateId": "9",
      "name": "test variable template",
      "fingerprint": "1694938308152",
      "templateData": "___TERMS_OF_SERVICE___\n\nBy creating or modifying this file you agree to Google Tag Manager's Community\nTemplate Gallery Developer Terms of Service available at\nhttps://developers.google.com/tag-manager/gallery-tos (or such other URL as\nGoogle may provide), as modified from time to time.\n\n\n___INFO___\n\n{\n  \"type\": \"MACRO\",\n  \"id\": \"cvt_temp_public_id\",\n  \"version\": 1,\n  \"securityGroups\": [],\n  \"displayName\": \"test variable template\",\n  \"description\": \"\",\n  \"containerContexts\": [\n    \"WEB\"\n  ]\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[]\n\n\n___SANDBOXED_JS_FOR_WEB_TEMPLATE___\n\n// Enter your template code here.\nconst log = require('logToConsole');\nlog('data =', data);\nlog('variable tempmlate', data);\n\n// Variables must return a value.\nreturn false;\n\n\n___WEB_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"logging\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"environments\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"debug\"\n          }\n        }\n      ]\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios: []\n\n\n___NOTES___\n\n\n\n\n"
    },
    {
      "path": "accounts/6000085367/containers/30089014/workspaces/4/templates/14",
      "accountId": "6000085367",
      "containerId": "30089014",
      "workspaceId": "4",
      "templateId": "14",
      "name": "Facebook CAPI Tag",
      "fingerprint": "1695377348691",
      "templateData": "___TERMS_OF_SERVICE___\n\nBy creating or modifying this file you agree to Google Tag Manager's Community\nTemplate Gallery Developer Terms of Service available at\nhttps://developers.google.com/tag-manager/gallery-tos (or such other URL as\nGoogle may provide), as modified from time to time.\n\n\n___INFO___\n\n{\n  \"type\": \"TAG\",\n  \"id\": \"cvt_temp_public_id\",\n  \"version\": 1,\n  \"securityGroups\": [],\n  \"displayName\": \"Facebook CAPI Tag\",\n  \"brand\": {\n    \"id\": \"github.com_peaksandpies\",\n    \"displayName\": \"peaksandpies\",\n    \"thumbnail\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACCCAYAAACKAxD9AAAACXBIWXMAABcRAAAXEQHKJvM/AAAJU0lEQVR4nO2dXWhcRRTHZ3eTtNt0u0lbWm+xdCs+qC0kBYsoxWzBl4LiFt/8wBREH/zaKsKCQlNF2BchBfvmR/Kg+FJIFPRJTV76UoUEKpUKbdZa15akzWap2+ZjV2Z7FreZO3fvx9y5M/eeHywbdnaTmzv/PXPmzMw5sUajQRAkHvk7gDRBISBNUAhIExQC0qQrrLfBKFSzhJAMPAYJIX3w8x7mzXymoWWGELJICJkihMyVi6k57ic0JRSzBqNQpZ2cbXsMMG8SSwVE0XyUi6kZ2f+zaLQVglGo0m/5MJHT8Z1oCWOCPsrF1GKH9yuHVkIwClVq2vOEkJxDEy+bSRDEmMLXeA9aCMEoVIfh2z/ENKoNtRRUDKOq+xXKCgHG/WGwACp/++0yTkVRLqamVLw45YQAAsjDI828QX/oTGRENUEoJQQYAkZCYgE6MQ6CUGLIUEIIMAMY1dAH8EoF/IeRoC8kUCHAMEBvwttMY7QoUX8oyOEiMCFA5G8sIsOAXU7BcCE9DhHIWoNRqFIr8DOKgIFaxikYKqUi1SLAUDARQV/AKdR3yMsMSEkTAqh8KqRTQr8YLxdTwzL+kBQhwLRwFEXgChp3yPntN/guBBDBl0wD4oRZurjmpxh8dRbBKUQReGfAbyfSN4tgFKrU0XmZaUC8UAHLIHz/gy8WASwBikA8abAMGdG/WbhFQJ9ACsJ9BqEWAUUgjZbP0CfqDwoTAjgyKAJ5DECIXghChgZQ5lwU4gT7dsVJemOMef18uU6WaoGs25wUsXopSggzCmwgFcqWZIw8s7+r9tjexI1H9yRW926L214XWVkjtb8W69fpz5fm6/G5hXr9Qrm+4/JCPXnlZoNcuVlnPuORo+ViasLLr/AsBKNQHQ3TMvILB7trrxzqWXpoZ3wn0yiAz88ulz749o7oxTY6rRz0ssnF0wEXWEoOhQjeP7Kh8tqhnp7uBEkS0nzoRBr8hazba3btLLatJGrNEw8kyO8nNlfeGOpJgwh0ZQjiN3KFEIZFpE+e2zh/5tVNJJ2MhcXJPeE22ORqaIAhQdvIIXUEf3xr0437++PbmUb9cTVEuLUI2pzgWU+bCLYyjeFgCAJ7jnAsBBiHtN1iFnIRtBh1GnV0JIS2wydaQn2CCIiAgO/mqJ+cWgRtTx/R2cHzB7vD6BPwyDuxCraFoLM1oH7BFy8lK0xDuHFkFZxYBG2twZvZnkqIpohOsG0VbAlBd2tAI4ZMQzSwbRXsWoScrtaALhxpHjH0iq2ppF0hBH5I0y3vPLXhlp5XLow9duIKHYUAUUQt4wa7++NkVzoWpZkCj45CsBNilnLSxg+efDBRk7WSuHS7cXPhVmOJaVjHxWv1zcyL/kOjjRmrZWo7Qsgxr2jCkf1d89Qw+HW1lVqj8tH3d3q+O7+aXKo1+gkh/cyb1CEHC4WmWArBKFS1dRIp+4yEb7OFT6eXKx//cEenezNsJYROPoK21oBy35aYL7uMvj63Mq+ZCCgDVkvUoRUCjR/4AR0O3j1zW1cHlNufXCHA9nRth4X9Bvdf88Tp6WXhO08lwt2nYHW3uB+KMj9dXFXZIewEt09RCA757W+dDQJJ805UoxAc8M9S45o2F8vHtF9NhQDeJWY3WUdtpXGbeVE/HFkE0zcjocC0b1EI0cP0aCIKIYKYOYw8IQg7d48oCdO/PCEwikFCBdO/PCHgjCHcdLYIItOxIMrC9DEjBDOzgYQOpo/NhIBEEBQC0gSFgDSx3KqmAp+9mLzwiBHf5PRSkt2xjYQQoTuUdvfHt599r7fENDjg9NTyjq/OrSh3zkJ5ITy+N7G8tTf2MNMQAF1x0rt3W7zXy1++vKDmMjYODZKh6fVUBIUgEZp/0Ycci0JAIUiklYRTRRghqFq7OAz8UlpTxSdj+pgRAuIff1yvO579yIInhKhlF5HCr3+uqbIDmqnzwBOC8FIxyN0M7orA9C9PCNxTs4g76GnpgNL4m8H0LwpBEterjX9VuRaz4/E8ITBeJeKN6T9WVxW5hdPMKxZCYBSDeIMW7lDkFpr2rakQwHR4WlxB7mXm6poqC02m1t5UCADjWSLuUejMpGm/WgnBVDmIcxQ6M1nhVZFFIUjg6mJ9WZFL4fapZXEvo1CdCzq1Hq+8XufPJciHT29gXvcC/Wa//k3N8WYXnyq7ueFYuZgyrbXRaRFkIujiXSrlI6Cnoc9eWmNe1whuDS6roYFYmRJEO2ataklbCgGKSuI0MhxwU+sRm8vQXHOCaIVlP9oRgqlzgWjFpNWwYEsIMO80jU8j2mA5LNgSAoBWQV9KdrYf2hICzD3RadQTW7U2nOxZ7GheEOWo8AJIXoQwhnsZtcP2l9e2EMDrRKugDxVfhEDuimEEfQVtyHeaMrbj5lyDtoW+IkTJrm/QwrEQ4A9gXEFt/K8WD2hbKDwCTLo5tuhKCBBtPMk0IEFTcVuVz/XZR3AcZ5kGJEiGnTiIQoQAaFsTMoRMwrYBV3gSAgwRx5kGRDYlr19Kz8fiy8UUDVqMMw2ILKhfkHM7JLQQlR8hj/5CYOR5W9SdIEQIoMYcrkVI55TTwBEPYRlT4JhcFsUgjfFyMSUsniM0dQ6YKJxJ+A/dkSz0PgvPoQRTmGNMAyKKWV7JPi/4kkwLxi0Ug3iaIvA6QzDDt6xqKAbh+CYC4nd6PRDDYXQgPTPupwiIjDyLsBKGswn30NmB6zUEu0hJuAmziQwGnRxzTPTsgIe0zKtU0eViitYSOsU0IuuhawcHRAWL7CA9BS8EQY7iUMFlkhbfEhE2dkIguZgh1jCIW97ugX4xjpeLKc8LSG4ILCk3DUmXi6ksTDGjbh1aViCw4wKBZ2eHcTAT0aVs6gscBStgmv9QFkqk6QdHknrHByIyXFALeLJcTGW87CoSiVL1GqiDBMPF4ZAKogKbfjOw51MZlKzy1gpCGYVqFg7UDDFv0ovW8bPRIBxBOyhd7q9NEBnYBTWsWSV7atXGZMYD3KJ83Ufy/6YXKoS8UajmQBDPMm9UgxKcHB8L2gF0ghZCaAecqwmjUO2DNYwcPAeZGHQaklVNyQ4EiUI7IbSAsXailS3MKFQHIUiVhecB5kNiqEBi6yl4zKg67jvBMgVvCBiEGAV97oPnFjwHtNRW02AROr31PGNWGCsMhF0IiE2w7iPSBIWANEEhIIQQQv4D8wEO4mJgh1EAAAAASUVORK5CYII\\u003d\"\n  },\n  \"description\": \"An unofficial template for Facebook CAPI tracking. It is intended to be used with the Server-side Google Tag Manager and the Facebook CAPI Client.\",\n  \"containerContexts\": [\n    \"WEB\"\n  ],\n  \"categories\": [\n    \"ADVERTISING\",\n    \"CONVERSIONS\",\n    \"MARKETING\"\n  ]\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[\n  {\n    \"type\": \"TEXT\",\n    \"name\": \"url\",\n    \"displayName\": \"URL\",\n    \"simpleValueType\": true,\n    \"valueValidators\": [\n      {\n        \"type\": \"NON_EMPTY\"\n      },\n      {\n        \"type\": \"REGEX\",\n        \"args\": [\n          \"^https:\\\\/\\\\/.+\"\n        ],\n        \"errorMessage\": \"The value must be a valid URL.\"\n      }\n    ],\n    \"valueHint\": \"https://www.server.com/track\",\n    \"help\": \"The URL of your server-side GTM (or similar solution), which accepts the data and sends it to Facebook.\"\n  },\n  {\n    \"type\": \"TEXT\",\n    \"name\": \"id\",\n    \"displayName\": \"Pixel ID\",\n    \"simpleValueType\": true,\n    \"valueValidators\": [\n      {\n        \"type\": \"NON_EMPTY\"\n      }\n    ]\n  },\n  {\n    \"type\": \"RADIO\",\n    \"name\": \"radioButton\",\n    \"displayName\": \"Event Name\",\n    \"radioItems\": [\n      {\n        \"value\": \"standard\",\n        \"displayValue\": \"Standard\",\n        \"subParams\": [\n          {\n            \"type\": \"SELECT\",\n            \"name\": \"standardEvent\",\n            \"displayName\": \"Event\",\n            \"macrosInSelect\": false,\n            \"selectItems\": [\n              {\n                \"value\": \"AddPaymentInfo\",\n                \"displayValue\": \"AddPaymentInfo\"\n              },\n              {\n                \"value\": \"AddToCart\",\n                \"displayValue\": \"AddToCart\"\n              },\n              {\n                \"value\": \"AddToWishlist\",\n                \"displayValue\": \"AddToWishlist\"\n              },\n              {\n                \"value\": \"CompleteRegistration\",\n                \"displayValue\": \"CompleteRegistration\"\n              },\n              {\n                \"value\": \"Contact\",\n                \"displayValue\": \"Contact\"\n              },\n              {\n                \"value\": \"CustomizeProduct\",\n                \"displayValue\": \"CustomizeProduct\"\n              },\n              {\n                \"value\": \"Donate\",\n                \"displayValue\": \"Donate\"\n              },\n              {\n                \"value\": \"FindLocation\",\n                \"displayValue\": \"FindLocation\"\n              },\n              {\n                \"value\": \"InitiateCheckout\",\n                \"displayValue\": \"InitiateCheckout\"\n              },\n              {\n                \"value\": \"Lead\",\n                \"displayValue\": \"Lead\"\n              },\n              {\n                \"value\": \"PageView\",\n                \"displayValue\": \"PageView\"\n              },\n              {\n                \"value\": \"Purchase\",\n                \"displayValue\": \"Purchase\"\n              },\n              {\n                \"value\": \"Schedule\",\n                \"displayValue\": \"Schedule\"\n              },\n              {\n                \"value\": \"Search\",\n                \"displayValue\": \"Search\"\n              },\n              {\n                \"value\": \"StartTrial\",\n                \"displayValue\": \"StartTrial\"\n              },\n              {\n                \"value\": \"SubmitApplication\",\n                \"displayValue\": \"SubmitApplication\"\n              },\n              {\n                \"value\": \"Subscribe\",\n                \"displayValue\": \"Subscribe\"\n              },\n              {\n                \"value\": \"ViewContent\",\n                \"displayValue\": \"ViewContent\"\n              }\n            ],\n            \"simpleValueType\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"value\": \"custom\",\n        \"displayValue\": \"Custom\",\n        \"subParams\": [\n          {\n            \"type\": \"TEXT\",\n            \"name\": \"customEvent\",\n            \"displayName\": \"\",\n            \"simpleValueType\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ]\n          }\n        ]\n      }\n    ],\n    \"simpleValueType\": true\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"privacyGroup\",\n    \"displayName\": \"Privacy\",\n    \"groupStyle\": \"NO_ZIPPY\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"anonymiseIP\",\n        \"checkboxText\": \"Anonymise IP address\",\n        \"simpleValueType\": true\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"anonymiseUserAgent\",\n        \"checkboxText\": \"Anonymise user agent\",\n        \"simpleValueType\": true\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"objectPropertiesGroup\",\n    \"displayName\": \"Object Properties\",\n    \"groupStyle\": \"ZIPPY_OPEN_ON_PARAM\",\n    \"subParams\": [\n      {\n        \"type\": \"SELECT\",\n        \"name\": \"objectProperties\",\n        \"displayName\": \"Object Properties Variable\",\n        \"macrosInSelect\": true,\n        \"selectItems\": [],\n        \"simpleValueType\": true,\n        \"notSetText\": \"Undefined\"\n      },\n      {\n        \"type\": \"SIMPLE_TABLE\",\n        \"name\": \"objectPropertiesTable\",\n        \"simpleTableColumns\": [\n          {\n            \"defaultValue\": \"\",\n            \"displayName\": \"Property Name\",\n            \"name\": \"name\",\n            \"type\": \"TEXT\",\n            \"isUnique\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ]\n          },\n          {\n            \"defaultValue\": \"\",\n            \"displayName\": \"Property Value\",\n            \"name\": \"value\",\n            \"type\": \"TEXT\",\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ]\n          }\n        ],\n        \"newRowButtonText\": \"Add Property\"\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"optionalGroup\",\n    \"displayName\": \"Optional\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"TEXT\",\n        \"name\": \"eventId\",\n        \"displayName\": \"Event ID\",\n        \"simpleValueType\": true,\n        \"help\": \"The event_id parameter is an identifier that can uniquely distinguish between similar events. Read more about the \\u003ca href\\u003d\\\"https://developers.facebook.com/docs/marketing-api/conversions-api/parameters/server-event#event-id\\\"\\u003eevent_id parameter\\u003c/a\\u003e.\"\n      }\n    ]\n  }\n]\n\n\n___SANDBOXED_JS_FOR_WEB_TEMPLATE___\n\nconst encodeUriComponent = require('encodeUriComponent');\nconst getCookieValues = require('getCookieValues');\nconst getReferrerUrl = require('getReferrerUrl');\nconst getType = require('getType');\nconst getUrl = require('getUrl');\nconst JSON = require('JSON');\nconst makeTableMap = require('makeTableMap');\nconst parseUrl = require('parseUrl');\nconst sendPixel = require('sendPixel');\n\nconst mergeObjects = (a, b) => {\n  for(let key in b) {\n    if(b.hasOwnProperty(key)) {\n      a[key] = b[key];\n    }\n  }\n  \n  return a;\n};\n\nconst event = data.standardEvent || data.customEvent;\nconst eventId = data.eventId;\nconst id = data.id;\nconst properties = getType(data.objectProperties) === 'object' ? data.objectProperties : {};\nconst propertiesTable = data.objectPropertiesTable && data.objectPropertiesTable.length ? makeTableMap(data.objectPropertiesTable, 'name', 'value') : {};\nconst mergedProperties = mergeObjects(properties, propertiesTable);\n\nconst transformData = () => {\n  let transformedUrl = data.url + '?v=1&t=pp_capi';\n  const parsedUrl = parseUrl(getUrl());\n  \n  const parameters = [\n    {key: 'dl', value: parsedUrl.href},\n    {key: 'dr', value: getReferrerUrl()},\n    {key: 'en', value: event},\n    {key: 'eid', value: eventId},\n    {key: 'fbc', value: getCookieValues('_fbc')},\n    {key: 'fbp', value: getCookieValues('_fbp')},\n    {key: 'pid', value: id},\n    {key: 'aip', value: data.anonymiseIP},\n    {key: 'aua', value: data.anonymiseUserAgent}\n  ];\n  \n  for(let parameter of parameters) {\n    if(parameter.value == undefined || parameter.value == '') {\n      continue;\n    }\n    \n    transformedUrl += '&' + parameter.key + '=' + encodeUriComponent(parameter.value);\n  }\n  \n  for(let property in mergedProperties) {\n    let value = mergedProperties[property];\n    \n    if(['array', 'object'].indexOf(getType(value)) > -1) {\n      value = JSON.stringify(value);\n    }\n    \n    transformedUrl += '&cd[' + property + ']=' + encodeUriComponent(value);\n  }\n  \n  return transformedUrl;\n};\n\nconst url = transformData();\n\nsendPixel(url, data.gtmOnSuccess, data.gtmOnFailure);\n\n\n___WEB_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"send_pixel\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"allowedUrls\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"get_referrer\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"urlParts\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        },\n        {\n          \"key\": \"queriesAllowed\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"get_url\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"urlParts\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        },\n        {\n          \"key\": \"queriesAllowed\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"get_cookies\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"cookieAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"specific\"\n          }\n        },\n        {\n          \"key\": \"cookieNames\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 1,\n                \"string\": \"_fbc\"\n              },\n              {\n                \"type\": 1,\n                \"string\": \"_fbp\"\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios:\n- name: Standard Event\n  code: |-\n    const mockData = {\n      id: '123',\n      endpoint: 'www.test.com/collect',\n      standardEvent: 'PageView'\n    };\n\n    // Call runCode to run the template's code.\n    runCode(mockData);\n\n    // Verify that the tag finished successfully.\n    assertApi('gtmOnSuccess').wasCalled();\n\n\n___NOTES___\n\nCreated on 27/01/2022, 09:43:27\n\n\n",
      "galleryReference": {
        "host": "github.com",
        "owner": "peaksandpies",
        "repository": "gtm-facebook-capi-tag",
        "version": "9424eeafe7280c210ce758d5d98ece65989928bb",
        "signature": "0b3a67b1323d111644df983d25685d59deb1e4a6e377cefa57fb5064882be971"
      }
    },
    {
      "path": "accounts/6000085367/containers/30089014/workspaces/4/templates/15",
      "accountId": "6000085367",
      "containerId": "30089014",
      "workspaceId": "4",
      "templateId": "15",
      "name": "Cookie Information Consent State",
      "fingerprint": "1695377356488",
      "templateData": "___TERMS_OF_SERVICE___\n\nBy creating or modifying this file you agree to Google Tag Manager's Community\nTemplate Gallery Developer Terms of Service available at\nhttps://developers.google.com/tag-manager/gallery-tos (or such other URL as\nGoogle may provide), as modified from time to time.\n\n\n___INFO___\n\n{\n  \"type\": \"MACRO\",\n  \"id\": \"cvt_temp_public_id\",\n  \"version\": 1,\n  \"securityGroups\": [],\n  \"displayName\": \"Cookie Information Consent State\",\n  \"description\": \"Use with the Cookie Information CMP to signal the individual website user\\u0027s consent state to tags that are setting cookies.\",\n  \"containerContexts\": [\n    \"WEB\"\n  ],\n  \"categories\": [\n    \"TAG_MANAGEMENT\",\n    \"PERSONALIZATION\"\n  ],\n  \"brand\": {\n    \"displayName\": \"GunnarGriese\",\n    \"id\": \"github.com_GunnarGriese\"\n  }\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[\n  {\n    \"type\": \"SELECT\",\n    \"name\": \"consentType\",\n    \"displayName\": \"Consent Type\",\n    \"macrosInSelect\": false,\n    \"selectItems\": [\n      {\n        \"value\": \"cookie_cat_necessary\",\n        \"displayValue\": \"cookie_cat_necessary\"\n      },\n      {\n        \"value\": \"cookie_cat_functional\",\n        \"displayValue\": \"cookie_cat_functional\"\n      },\n      {\n        \"value\": \"cookie_cat_statistic\",\n        \"displayValue\": \"cookie_cat_statistic\"\n      },\n      {\n        \"value\": \"cookie_cat_marketing\",\n        \"displayValue\": \"cookie_cat_marketing\"\n      },\n      {\n        \"value\": \"cookie_cat_unclassified\",\n        \"displayValue\": \"cookie_cat_unclassified\"\n      }\n    ],\n    \"simpleValueType\": true,\n    \"valueValidators\": [\n      {\n        \"type\": \"NON_EMPTY\"\n      }\n    ],\n    \"alwaysInSummary\": true\n  }\n]\n\n\n___SANDBOXED_JS_FOR_WEB_TEMPLATE___\n\nconst getCookieValues = require('getCookieValues');\nconst JSON = require('JSON');\nconst decodeUriComponent = require('decodeUriComponent');\nconst callInWindow = require('callInWindow');\nconst copyFromWindow = require('copyFromWindow');\n\nconst consentType = data.consentType;\nconst consentCookie = getCookieValues('CookieInformationConsent');\n\n// If cookie present check for consent saved here\nif (consentCookie.length > 0) {\n  const parsedCookieValue = JSON.parse(decodeUriComponent(consentCookie[0]));\n  const consentsApproved = parsedCookieValue.consents_approved; // Obtain consented categories\n  if (consentsApproved.indexOf(consentType) >= 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Return API response (if no cookie present)\nif (typeof copyFromWindow('CookieInformation') !== 'undefined'){\n  const apiConsent = copyFromWindow('CookieInformation').getConsentGivenFor(consentType);\n  return (typeof apiConsent !== 'undefined' ? true : false);\n}\n\n// Default return (no cookie, no API)\nreturn false;\n\n\n___WEB_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"access_globals\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"keys\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 3,\n                \"mapKey\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"key\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"read\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"write\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"execute\"\n                  }\n                ],\n                \"mapValue\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"CookieInformation\"\n                  },\n                  {\n                    \"type\": 8,\n                    \"boolean\": true\n                  },\n                  {\n                    \"type\": 8,\n                    \"boolean\": true\n                  },\n                  {\n                    \"type\": 8,\n                    \"boolean\": true\n                  }\n                ]\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"get_cookies\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"cookieAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"specific\"\n          }\n        },\n        {\n          \"key\": \"cookieNames\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 1,\n                \"string\": \"CookieInformationConsent\"\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios: []\n\n\n___NOTES___\n\nCreated on 14/07/2022, 12:01:31\n\n\n",
      "galleryReference": {
        "host": "github.com",
        "owner": "GunnarGriese",
        "repository": "gtm-template-cookie-info-consent-state",
        "version": "b7c4a84dfaaa11e89f3a6066124963a159a3ec4f",
        "signature": "ee9501b582e7bd5ab611ef8e42c271b6a4be6e10fa6fb0947d7ebe9259c48bc0"
      }
    }
  ]
}